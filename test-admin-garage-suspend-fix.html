<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin Garage Suspend Fix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .test-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 1000px;
            margin: 0 auto;
        }
        .test-title {
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            background: #f9fafb;
        }
        .test-section h3 {
            color: #374151;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }
        .test-button {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            text-decoration: none;
            display: inline-block;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        .test-button.success {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        .test-button.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        .test-result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            font-weight: 500;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .test-success {
            background: #ecfdf5;
            color: #059669;
            border: 1px solid #a7f3d0;
        }
        .test-info {
            background: #eff6ff;
            color: #1d4ed8;
            border: 1px solid #93c5fd;
        }
        .test-warning {
            background: #fffbeb;
            color: #d97706;
            border: 1px solid #fcd34d;
        }
        .test-error {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fca5a5;
        }
        .fix-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .fix-card {
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #d1d5db;
            background: white;
        }
        .fix-card h4 {
            margin-bottom: 10px;
            font-weight: 600;
            color: #374151;
        }
        .fix-card.success {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .fix-card.error {
            border-color: #ef4444;
            background: #fef2f2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">üîß Test Admin Garage Suspend Fix</h1>
        
        <div class="test-section">
            <h3>üêõ L·ªói ƒë√£ s·ª≠a</h3>
            
            <div class="fix-grid">
                <div class="fix-card error">
                    <h4>‚ùå L·ªói Backend</h4>
                    <p><strong>Error:</strong> <code>Name for argument of type [java.lang.Long] not specified</code></p>
                    <p><strong>Nguy√™n nh√¢n:</strong> Parameter <code>garageId</code> trong AdminController kh√¥ng c√≥ annotation r√µ r√†ng</p>
                </div>
                
                <div class="fix-card success">
                    <h4>‚úÖ ƒê√£ s·ª≠a</h4>
                    <p><strong>Fix:</strong> Th√™m <code>@PathVariable("garageId")</code> v√†o parameter</p>
                    <p><strong>File:</strong> <code>AdminController.java</code> line 266</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üß™ Test Admin Garage Suspend</h3>
            <p>Ki·ªÉm tra ch·ª©c nƒÉng t·∫°m ng∆∞ng garage sau khi s·ª≠a l·ªói:</p>
            
            <div style="text-align: center; margin: 20px 0;">
                <a href="http://localhost:3000/admin/garages" class="test-button">Test Admin Garage Management</a>
            </div>
            
            <div class="test-result test-info">
                <strong>Ki·ªÉm tra c·∫ßn th·ª±c hi·ªán:</strong>

                1. <strong>Backend Status:</strong>
                   - ƒê·∫£m b·∫£o backend ƒë√£ restart v√† ch·∫°y tr√™n port 8080
                   - Kh√¥ng c√≥ l·ªói trong console
                   - API endpoint ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng

                2. <strong>Test T·∫°m ng∆∞ng Garage:</strong>
                   - Truy c·∫≠p: http://localhost:3000/admin/garages
                   - T√¨m garage c√≥ status "Ho·∫°t ƒë·ªông" (ACTIVE)
                   - Click dropdown menu (3 ch·∫•m) ‚Üí "T·∫°m ng∆∞ng ho·∫°t ƒë·ªông"
                   - Modal popup hi·ªán ra
                   - Nh·∫≠p l√Ω do t·∫°m ng∆∞ng
                   - Click "T·∫°m ng∆∞ng"

                3. <strong>Ki·ªÉm tra k·∫øt qu·∫£:</strong>
                   - Kh√¥ng c√≥ l·ªói 500 Internal Server Error
                   - Garage status chuy·ªÉn th√†nh "B·ªã kh√≥a" (INACTIVE)
                   - Hi·ªÉn th·ªã l√Ω do t·∫°m ng∆∞ng d∆∞·ªõi status badge
                   - Toast notification hi·ªán "ƒê√£ t·∫°m ng∆∞ng garage th√†nh c√¥ng!"

                4. <strong>Test K√≠ch ho·∫°t l·∫°i:</strong>
                   - T√¨m garage c√≥ status "B·ªã kh√≥a" (INACTIVE)
                   - Click dropdown menu ‚Üí "K√≠ch ho·∫°t l·∫°i"
                   - Click ƒë·ªÉ x√°c nh·∫≠n
                   - Garage chuy·ªÉn th√†nh "Ho·∫°t ƒë·ªông" (ACTIVE)
            </div>
        </div>

        <div class="test-section">
            <h3>üîß Technical Fix Details</h3>
            <div class="test-result test-success">
                <strong>Backend Fix (AdminController.java):</strong>

                <strong>Before (L·ªói):</strong>
                @PutMapping("/garages/{garageId}/status")
                public ResponseEntity<GarageResponseDto> updateGarageStatus(
                    @PathVariable Long garageId,  // ‚ùå Thi·∫øu t√™n parameter
                    @RequestBody UpdateStatusRequest request) {

                <strong>After (ƒê√£ s·ª≠a):</strong>
                @PutMapping("/garages/{garageId}/status")
                public ResponseEntity<GarageResponseDto> updateGarageStatus(
                    @PathVariable("garageId") Long garageId,  // ‚úÖ C√≥ t√™n parameter r√µ r√†ng
                    @RequestBody UpdateStatusRequest request) {

                <strong>Nguy√™n nh√¢n l·ªói:</strong>
                - Spring Boot kh√¥ng th·ªÉ x√°c ƒë·ªãnh t√™n parameter t·ª´ reflection
                - C·∫ßn annotation @PathVariable v·ªõi t√™n r√µ r√†ng
                - Compiler flag -parameters c√≥ th·ªÉ gi√∫p nh∆∞ng annotation r√µ r√†ng t·ªët h∆°n

                <strong>API Endpoint:</strong>
                - PUT /apis/admin/garages/{garageId}/status
                - Request Body: { "status": "INACTIVE", "rejectionReason": "L√Ω do..." }
                - Response: GarageResponseDto v·ªõi status m·ªõi
            </div>
        </div>

        <div class="test-section">
            <h3>üì± User Experience Flow</h3>
            <div class="test-result test-info">
                <strong>Admin Experience (ƒê√£ s·ª≠a):</strong>

                1. <strong>T·∫°m ng∆∞ng Garage:</strong>
                   - Admin click "T·∫°m ng∆∞ng ho·∫°t ƒë·ªông"
                   - Modal popup hi·ªán ra
                   - Nh·∫≠p l√Ω do ‚Üí Click "T·∫°m ng∆∞ng"
                   - ‚úÖ Kh√¥ng c√≥ l·ªói 500
                   - ‚úÖ Garage chuy·ªÉn th√†nh INACTIVE
                   - ‚úÖ Hi·ªÉn th·ªã l√Ω do t·∫°m ng∆∞ng

                2. <strong>K√≠ch ho·∫°t l·∫°i Garage:</strong>
                   - Admin click "K√≠ch ho·∫°t l·∫°i"
                   - Click ƒë·ªÉ x√°c nh·∫≠n
                   - ‚úÖ Garage chuy·ªÉn th√†nh ACTIVE
                   - ‚úÖ Notification g·ª≠i cho ch·ªß garage

                <strong>Garage Owner Experience:</strong>
                - Nh·∫≠n notification khi b·ªã t·∫°m ng∆∞ng
                - Nh·∫≠n notification khi ƒë∆∞·ª£c k√≠ch ho·∫°t l·∫°i
                - Xem l√Ω do t·∫°m ng∆∞ng trong notification

                <strong>System Behavior:</strong>
                - Garage INACTIVE kh√¥ng nh·∫≠n l·ªãch h·∫πn m·ªõi
                - Garage ACTIVE ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng
                - Notification system ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh
            </div>
        </div>

        <div class="test-section">
            <h3>‚úÖ Expected Results</h3>
            <div class="test-result test-success">
                <strong>K·∫øt qu·∫£ mong ƒë·ª£i sau khi s·ª≠a:</strong>

                1. <strong>Backend:</strong>
                   - Kh√¥ng c√≥ l·ªói IllegalArgumentException
                   - API endpoint ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng
                   - Database update th√†nh c√¥ng
                   - Notification g·ª≠i ƒë√∫ng

                2. <strong>Frontend:</strong>
                   - Modal popup hi·ªán ra khi click "T·∫°m ng∆∞ng ho·∫°t ƒë·ªông"
                   - Validation ho·∫°t ƒë·ªông (l√Ω do b·∫Øt bu·ªôc)
                   - Loading state hi·ªÉn th·ªã khi ƒëang x·ª≠ l√Ω
                   - Toast notification hi·ªán khi th√†nh c√¥ng

                3. <strong>UI/UX:</strong>
                   - Status badge c·∫≠p nh·∫≠t real-time
                   - L√Ω do t·∫°m ng∆∞ng hi·ªÉn th·ªã d∆∞·ªõi status
                   - N√∫t "K√≠ch ho·∫°t l·∫°i" hi·ªán v·ªõi garage INACTIVE
                   - N√∫t "T·∫°m ng∆∞ng ho·∫°t ƒë·ªông" hi·ªán v·ªõi garage ACTIVE

                4. <strong>Data Consistency:</strong>
                   - Garage status ƒë∆∞·ª£c l∆∞u ƒë√∫ng trong database
                   - L√Ω do t·∫°m ng∆∞ng ƒë∆∞·ª£c l∆∞u v√† hi·ªÉn th·ªã
                   - Notification ƒë∆∞·ª£c t·∫°o v√† g·ª≠i
                   - Audit trail ƒë∆∞·ª£c duy tr√¨
            </div>
        </div>

        <div class="test-section">
            <h3>üöÄ Test Checklist</h3>
            <div class="test-result test-warning">
                <strong>Checklist ki·ªÉm tra:</strong>

                ‚ñ° Backend ƒë√£ restart v√† ch·∫°y ·ªïn ƒë·ªãnh
                ‚ñ° Kh√¥ng c√≥ l·ªói trong console
                ‚ñ° Truy c·∫≠p /admin/garages th√†nh c√¥ng
                ‚ñ° Dropdown menu hi·ªÉn th·ªã ƒë√∫ng n√∫t theo status
                ‚ñ° Modal popup hi·ªán ra khi click "T·∫°m ng∆∞ng ho·∫°t ƒë·ªông"
                ‚ñ° Validation ho·∫°t ƒë·ªông (kh√¥ng cho submit khi thi·∫øu l√Ω do)
                ‚ñ° API call th√†nh c√¥ng (kh√¥ng c√≥ l·ªói 500)
                ‚ñ° Garage status chuy·ªÉn ƒë·ªïi ƒë√∫ng
                ‚ñ° L√Ω do t·∫°m ng∆∞ng hi·ªÉn th·ªã trong UI
                ‚ñ° Toast notification hi·ªán khi th√†nh c√¥ng
                ‚ñ° N√∫t "K√≠ch ho·∫°t l·∫°i" ho·∫°t ƒë·ªông v·ªõi garage INACTIVE
                ‚ñ° Notification g·ª≠i cho ch·ªß garage
                ‚ñ° Garage INACTIVE kh√¥ng nh·∫≠n l·ªãch h·∫πn m·ªõi
                ‚ñ° Garage ACTIVE ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng

                <strong>N·∫øu v·∫´n c√≥ l·ªói:</strong>
                - Ki·ªÉm tra console browser (F12)
                - Ki·ªÉm tra console backend
                - Ki·ªÉm tra network tab trong DevTools
                - ƒê·∫£m b·∫£o backend ƒë√£ restart
            </div>
        </div>
    </div>

    <script>
        // Auto test
        function testGarageSuspendFix() {
            console.log('üîß Testing garage suspend fix...');
            
            // Test current URL
            const currentUrl = window.location.href;
            console.log('Current URL:', currentUrl);
            
            // Check if we're on admin garages page
            if (currentUrl.includes('/admin/garages')) {
                console.log('‚úÖ On Admin Garage Management page - checking for suspend button...');
                
                // Look for suspend button
                const suspendButton = document.querySelector('button:has(span:contains("T·∫°m ng∆∞ng ho·∫°t ƒë·ªông"))');
                if (suspendButton) {
                    console.log('‚úÖ Suspend button found');
                } else {
                    console.log('‚ÑπÔ∏è Suspend button not found (no ACTIVE garages or not visible)');
                }
                
                // Check for activate button
                const activateButton = document.querySelector('button:has(span:contains("K√≠ch ho·∫°t l·∫°i"))');
                if (activateButton) {
                    console.log('‚úÖ Activate button found');
                } else {
                    console.log('‚ÑπÔ∏è Activate button not found (no INACTIVE garages or not visible)');
                }
            }
        }
        
        // Run test on load
        setTimeout(testGarageSuspendFix, 1000);
    </script>
</body>
</html>
